(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["sale"],{"17f8":function(t,e,i){"use strict";i.r(e);i("7514");var n=i("9ab4"),o=i("60a3"),r=i("2474"),a=i("0eeb"),s=i("79b4"),d=i.n(s),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n["c"](e,t),Object.defineProperty(e.prototype,"content",{get:function(){return a["c"][this.$i18n.locale]},enumerable:!0,configurable:!0}),e=n["b"]([d.a,o["a"]],e),e}(Object(o["b"])(r["WindowMixin"])),p=c,u={id:{identifier:"saleId",description:"The database id of the sale, highly classified !!",type:"text",immutable:!0,internal:!0},date:{identifier:":i18n:products.bindings.sale.date.identifier",description:":i18n:products.bindings.sale.date.description",type:"date",immutable:!0},billingId:{identifier:":i18n:products.bindings.sale.billingId.identifier",description:":i18n:products.bindings.sale.billingId.description",type:"text",immutable:!0},customer:{identifier:":i18n:products.bindings.sale.customer.identifier",description:":i18n:products.bindings.sale.customer.description",type:"text",immutable:!0},products:{identifier:":i18n:products.bindings.sale.products.identifier",description:":i18n:products.bindings.sale.products.description",type:"array[Product]",immutable:!0},total:{identifier:":i18n:products.bindings.sale.total.identifier",description:":i18n:products.bindings.sale.total.description",type:"currency",immutable:!0}},l=(i("6b54"),i("ac6a"),i("a0c7")),g=i("63f6"),f=i.n(g),m=(i("36c2"),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.products=null,e.columns=[new r["TableColumn"]({name:":i18n:products.bindings.product.reference.identifier",varName:"reference",sortable:!0}),new r["TableColumn"]({name:":i18n:products.bindings.product.name.identifier",varName:"name",sortable:!0}),new r["TableColumn"]({name:":i18n:products.bindings.product.price.identifier",varName:"price",sortable:!0,sortFunction:function(t,e,i){t=new l["TypedNumber"]({value:t,type:"currency"}),e=new l["TypedNumber"]({value:e,type:"currency"});var n=t.value.cmp(e.value);return i?n:-1*n},renderFunction:function(t){return new l["TypedNumber"]({value:t,type:"currency"})}})],e}return n["c"](e,t),Object.defineProperty(e.prototype,"saleProducts",{get:function(){var t=this;if(this.products){var e=[];return this.pageData().products.forEach(function(i){return e.push(t.products.find(function(t){return t.id===i}))}),e}return[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementNameTranslation",{get:function(){return this.$t("products.productList").toString()},enumerable:!0,configurable:!0}),e.prototype.goToProduct=function(t){this.$router.push("/products/"+t.item.id)},e.prototype.created=function(){var t=this;this.$store.dispatch("getProducts").then(function(e){t.products=e})},e=n["b"]([f.a,Object(o["a"])({components:{DynamicElementWrapper:r["DynamicElementWrapper"]}})],e),e}(Object(o["b"])(r["DynamicElementWrapperMixin"]))),h=m,b=function(t){function e(e){return void 0===e&&(e={}),t.call(this,n["a"]({},e,{type:"productList",component:h,unique:!0,wrapperAlignment:"top",wrapperOverflow:"auto",minHeight:10,minWidth:4,startHeight:12}))||this}return n["c"](e,t),e.prototype.clone=function(){return new e(this.cloneOptions())},e}(r["DynamicPageElement"]),y=[new r["DynamicPageStatElement"]({identifier:":i18n:sales.totalExclVAT",useFlow:!0,flowId:"total",adaptivePosition:{lg:{x:3,y:1,width:2,height:3},md:{x:1,y:1,width:2,height:3},sm:{x:0,y:1,width:2,height:3}}}),new r["DynamicPageStatElement"]({identifier:":i18n:sales.productCount",useFlow:!0,flowId:"productCount",adaptivePosition:{lg:{x:5,y:1,width:2,height:3},md:{x:4,y:1,width:2,height:3},sm:{x:2,y:1,width:2,height:3}}}),new r["DynamicPageStatElement"]({identifier:":i18n:sales.date",useFlow:!0,flowId:"date",adaptivePosition:{lg:{x:3,y:4,width:4,height:3},md:{x:2,y:4,width:3,height:3},sm:{x:1,y:4,width:2,height:3}}}),new r["DynamicPageStatElement"]({identifier:":i18n:sales.customer",useFlow:!0,flowId:"customer",size:"smaller",adaptivePosition:{lg:{x:3,y:8,width:4,height:3},md:{x:2,y:8,width:3,height:3},sm:{x:1,y:7,width:2,height:3}}}),new b({id:"productList",identifier:":i18n:products.productList",adaptivePosition:{lg:{x:0,y:14,width:10,height:18},md:{x:0,y:14,width:7,height:18},sm:{x:0,y:11,width:4,height:20},xs:{x:0,y:12,width:1,height:24}}})],w={id:"total",group:"sale",steps:[{id:"renderer",type:"renderer",root:!0,pos:{x:275,y:25},inboundPorts:[{id:"valuePort",definitionName:"value",destination:{stepId:"pageData",portId:"pageDataTotal"}}]},{id:"pageData",type:"pageData",pos:{x:25,y:25},outboundPorts:[{id:"pageDataTotal",definitionName:"total",destination:{stepId:"renderer",portId:"valuePort"}}]}]},v={id:"date",group:"sale",steps:[{id:"renderer",type:"renderer",root:!0,pos:{x:275,y:25},inboundPorts:[{id:"valuePort",definitionName:"value",destination:{stepId:"pageData",portId:"pageDataDate"}}]},{id:"pageData",type:"pageData",pos:{x:25,y:25},outboundPorts:[{id:"pageDataDate",definitionName:"date",destination:{stepId:"renderer",portId:"valuePort"}}]}]},P={id:"customer",group:"sale",steps:[{id:"renderer",type:"renderer",root:!0,pos:{x:275,y:25},inboundPorts:[{id:"valuePort",definitionName:"value",destination:{stepId:"pageData",portId:"pageDataCustomer"}}]},{id:"pageData",type:"pageData",pos:{x:25,y:25},outboundPorts:[{id:"pageDataCustomer",definitionName:"customer",destination:{stepId:"renderer",portId:"valuePort"}}]}]},x={id:"productCount",group:"sale",steps:[{id:"renderer",type:"renderer",root:!0,pos:{x:525,y:75},inboundPorts:[{id:"valuePort",definitionName:"value",destination:{stepId:"arrayLength",portId:"valuePort"}}]},{id:"arrayLength",type:"arrayLength",pos:{x:275,y:75},inboundPorts:[{id:"arrayPort",definitionName:"array",destination:{stepId:"pageData",portId:"pageDataProductArray"}}],outboundPorts:[{id:"valuePort",definitionName:"value",destination:{stepId:"renderer",portId:"valuePort"}}]},{id:"pageData",type:"pageData",pos:{x:25,y:25},outboundPorts:[{id:"pageDataProductArray",definitionName:"products",destination:{stepId:"arrayLength",portId:"arrayPort"}}]}]},D=i("bc9d"),I=i.n(D),$=i("3f0c"),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loading=0,e.error=null,e.sale=null,e.elements=y,e.bindings=u,e.userBindings={},e.edit=!1,e}return n["c"](e,t),Object.defineProperty(e.prototype,"pool",{get:function(){return[new b({id:"productList"})]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mergedBindings",{get:function(){return n["a"]({},this.bindings,this.userBindings)},enumerable:!0,configurable:!0}),e.prototype.openKnowMoreWindow=function(){this.openWindow({id:"saleKnowMore",title:":i18n:common.knowMore",icon:"question",width:500,height:400,component:p,centerOnOpen:!0})},e.prototype.openHelpWindow=function(){this.openWindow({id:"dynamicPageHelp",title:":i18n:common.dynamicPageHelp",icon:"question-circle",width:500,height:425,component:$["a"],centerOnOpen:!0})},e.prototype.created=function(){var t=this;this.loading=3,this.$store.dispatch("getSales").then(function(e){t.sale=e.find(function(e){return e.id===t.saleId})}).catch(function(e){t.error=e}).finally(function(){t.loading-=1}),this.$store.dispatch("getSalesListDef").then(function(e){e.length&&(t.elements=e)}).catch(function(e){t.error=e}).finally(function(){t.loading-=1}),this.$store.dispatch("getSaleExtBindings").then(function(e){t.userBindings=e}).catch(function(e){t.error=e}).finally(function(){t.loading-=1}),this.$store.state.semstrap&&this.$store.state.semstrap.flows||Object(r["FlowsStorePlugin"])(this.$store),this.$store.dispatch("semstrap/flows/groupBindings",{group:"sale",bindings:function(){return t.mergedBindings}}),this.$store.dispatch("semstrap/flows/create",w),this.$store.dispatch("semstrap/flows/create",v),this.$store.dispatch("semstrap/flows/create",P),this.$store.dispatch("semstrap/flows/create",x)},e.prototype.beforeDestroy=function(){this.$store.commit("salesListDef",this.elements),this.$store.commit("saleExtBindings",this.$refs.pooledDP.mutableUserBindings)},n["b"]([Object(o["c"])({type:String,required:!0})],e.prototype,"saleId",void 0),e=n["b"]([I.a,o["a"]],e),e}(Object(o["b"])(r["WindowManagerMixin"]));e["default"]=_},"36c2":function(t,e,i){},3846:function(t,e,i){i("9e1e")&&"g"!=/./g.flags&&i("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:i("0bfb")})},"63f6":function(t,e){var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("dynamic-element-wrapper",{attrs:{el:t.wrapperParam}},[t.saleProducts?i("strap-table",{attrs:{items:t.saleProducts,columns:t.columns,selectable:"",bordered:"","enable-row-events":""},on:{"row-click":t.goToProduct}}):t._e()],1)},n=[];t.exports=function(t){var e="function"===typeof t?t.options:t;return e.render=i,e.staticRenderFns=n,t}},"6b54":function(t,e,i){"use strict";i("3846");var n=i("cb7c"),o=i("0bfb"),r=i("9e1e"),a="toString",s=/./[a],d=function(t){i("2aba")(RegExp.prototype,a,t,!0)};i("79e5")(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?d(function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!r&&t instanceof RegExp?o.call(t):void 0)}):s.name!=a&&d(function(){return s.call(this)})},"79b4":function(t,e){var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("strap-window",[i("div",{staticClass:"strap fluid main container"},[i(t.content,{tag:"component"})],1)])},n=[];t.exports=function(t){var e="function"===typeof t?t.options:t;return e.render=i,e.staticRenderFns=n,t}},bc9d:function(t,e){var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"strap main responsive fluid container"},[i("h1",{staticClass:"strap header dividing"},[t._v(t._s(t.$t("sales.title"))),i("strap-button",{staticStyle:{float:"right","font-size":"1rem"},on:{click:t.openHelpWindow}},[t._v(t._s(t.$t("common.help")))]),i("strap-button",{staticStyle:{float:"right","font-size":"1rem"},on:{click:t.openKnowMoreWindow}},[t._v(t._s(t.$t("common.knowMore")))])],1),t._v(" "),i("strap-alert",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{spaced:""}},[i("strap-icon",{attrs:{slot:"icon",icon:"spinner",animation:"pulse",size:"3x"},slot:"icon"}),t._v(t._s(t.$t("common.loading")))],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"strap flex-grid",staticStyle:{flex:"0"}},[i("div",{staticClass:"row"},[i("strap-button",{attrs:{"toggle-model":t.edit,flat:"",color:"indigo"},on:{"update:toggleModel":function(e){t.edit=e},"update:toggle-model":function(e){t.edit=e}}},[t._v(t._s(t.$t("common.pageEditMode")))]),t._v(" "),i("strap-button",{attrs:{flat:"",color:"brown"},on:{click:function(e){return t.$refs.pooledDP.openPremadeWindow()}}},[t._v(t._s(t.$t("common.addElement")))]),t._v(" "),i("strap-button",{attrs:{flat:"",color:"purple"},on:{click:function(e){return t.$refs.pooledDP.openBindingsWindow()}}},[t._v(t._s(t.$t("common.bindingsWindow")))])],1)]),t._v(" "),t.loading?t._e():i("strap-pooled-dynamic-page",{ref:"pooledDP",attrs:{edit:t.edit,pool:t.pool,elements:t.elements,"page-data":t.sale,bindings:t.bindings,"user-bindings":t.userBindings}})],1)},n=[];t.exports=function(t){var e="function"===typeof t?t.options:t;return e.render=i,e.staticRenderFns=n,t}}}]);